{% extends 'galeria/base.html' %}
{% load static %}

{% block content %}
<section class="p-5">
    <h1>Lista de Peças</h1>
    <ul>
        {% for peca in pecas %}
            <li>
                <strong>Nome da Peça:</strong> {{ peca.nome }}<br>
                <a href="{% url 'editar_peca' peca.pk %}" class="btn btn-success btn-sm">Editar</a>
                <form action="{% url 'excluir_peca' peca.pk %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Tem certeza que deseja excluir esta peça?');">Excluir</button>
                </form>
            </li>
        {% empty %}
            <li>Nenhuma peça disponível.</li>
        {% endfor %}
    </ul>

    <!-- Paginação para peças -->
    <nav aria-label="Page navigation">
        <ul class="pagination">
            {% if pecas.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?pecas_page=1" aria-label="Primeira">
                        <span aria-hidden="true">&laquo;&laquo;</span>
                        <span class="sr-only">Primeira</span>
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?pecas_page={{ pecas.previous_page_number }}" aria-label="Anterior">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Anterior</span>
                    </a>
                </li>
            {% endif %}

            <li class="page-item disabled">
                <span class="page-link">
                    Página {{ pecas.number }} de {{ pecas.paginator.num_pages }}.
                </span>
            </li>

            {% if pecas.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?pecas_page={{ pecas.next_page_number }}" aria-label="Próxima">
                        <span aria-hidden="true">&raquo;</span>
                        <span class="sr-only">Próxima</span>
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?pecas_page={{ pecas.paginator.num_pages }}" aria-label="Última">
                        <span aria-hidden="true">&raquo;&raquo;</span>
                        <span class="sr-only">Última</span>
                    </a>
                </li>
            {% endif %}
        </ul>
    </nav>

    <h2 class="mt-5">Modelo das Peças</h2>
    <ul>
        {% for detalhe in detalhes_pecas %}
            <li>
                <strong>Peça:</strong> {{ detalhe.peca.nome }}<br>
                <strong>Código:</strong> {{ detalhe.codigo }}<br>
                <strong>Veículo:</strong> {{ detalhe.veiculo }}<br>
                <strong>Modelo:</strong> {{ detalhe.modelo }}<br>
                <strong>Quantidade Inicial:</strong> {{ detalhe.quantidade_inicial }}<br>
                <strong>Quantidade Final:</strong> {{ detalhe.quantidade_final }}<br>
                <strong>Valor Unitário:</strong> R$ {{ detalhe.valor_unitario }}<br>
                <a href="{% url 'editar_detalhes_peca' detalhe.pk %}" class="btn btn-success btn-sm">Editar</a>
                <form action="{% url 'excluir_detalhes_peca' detalhe.pk %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Tem certeza que deseja excluir os detalhes desta peça?');">Excluir</button>
                </form>
                <form action="{% url 'realizar_baixa_estoque' detalhe.pk %}" method="get" style="display:inline;">
                <button type="submit" class="btn btn-warning btn-sm">Baixa de Estoque</button>
            </form>

            </li>
        {% empty %}
            <li>Nenhum detalhe de peça disponível.</li>
        {% endfor %}
    </ul>

    <!-- Paginação para detalhes das peças -->
    <nav aria-label="Page navigation">
        <ul class="pagination">
            {% if detalhes_pecas.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?detalhes_page=1" aria-label="Primeira">
                        <span aria-hidden="true">&laquo;&laquo;</span>
                        <span class="sr-only">Primeira</span>
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?detalhes_page={{ detalhes_pecas.previous_page_number }}" aria-label="Anterior">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Anterior</span>
                    </a>
                </li>
            {% endif %}

            <li class="page-item disabled">
                <span class="page-link">
                    Página {{ detalhes_pecas.number }} de {{ detalhes_pecas.paginator.num_pages }}.
                </span>
            </li>

            {% if detalhes_pecas.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?detalhes_page={{ detalhes_pecas.next_page_number }}" aria-label="Próxima">
                        <span aria-hidden="true">&raquo;</span>
                        <span class="sr-only">Próxima</span>
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?detalhes_page={{ detalhes_pecas.paginator.num_pages }}" aria-label="Última">
                        <span aria-hidden="true">&raquo;&raquo;</span>
                        <span class="sr-only">Última</span>
                    </a>
                </li>
            {% endif %}
        </ul>
    </nav>
    <br>
    <a href="{% url 'cadastro_pecas' %}" class="btn btn-primary">Cadastrar Peças</a>
    <br>
</section>
{% endblock %}
